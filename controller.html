<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vote for the Next Song</title>
    <style>
        body { font-family: 'Helvetica Neue', sans-serif; text-align: center; padding: 20px; background-color: #121212; color: white; }
        
        /* Container Styles */
        .view-section { display: none; max-width: 500px; margin: 0 auto; }
        .active { display: block; }

        /* Form Styles */
        input { width: 90%; padding: 15px; margin: 10px 0; border-radius: 5px; border: none; font-size: 16px; }
        .btn { background-color: #1DB954; color: white; border: none; padding: 15px 30px; border-radius: 50px; font-size: 18px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 20px; }
        .btn:hover { background-color: #1ed760; }

        /* Song Buttons */
        .song-btn { display: block; width: 100%; padding: 20px; margin: 10px 0; background: #333; color: white; border: 1px solid #444; border-radius: 10px; font-size: 18px; cursor: pointer; text-align: left; }
        .song-btn:active { background: #1DB954; }

        /* Disclaimer Text */
        .disclaimer { font-size: 10px; color: #888; margin-top: 20px; line-height: 1.4; text-align: left; }
        .disclaimer a { color: #888; text-decoration: underline; }

        /* Thank You Links */
        .presave-links a { display: block; padding: 15px; margin: 15px 0; border-radius: 8px; text-decoration: none; font-weight: bold; }
        .spotify { background-color: #1DB954; color: white; }
        .apple { background-color: #FA243C; color: white; }
        
        h1 { margin-bottom: 30px; }
    </style>
</head>
<body>

    <div id="landing-view" class="view-section active">
        <h1>Welcome</h1>
        <p>Please enter your details to unlock the voting pad.</p>
        
        <form id="marketing-form">
            <input type="text" id="name" placeholder="Full Name" required>
            <input type="email" id="email" placeholder="Email Address" required>
            <input type="text" id="postcode" placeholder="Postcode" required>
            
            <button type="submit" class="btn">Continue</button>
        </form>

        <p class="disclaimer">
            By clicking Continue, you agree to receive marketing updates from Luke Coombs and their team. We LSEPP collect this data on the Artist's behalf and will share it with their marketing team to send you news about tours, music, and merch. You can unsubscribe at any time using the link in our emails. See our <a href="#">[Privacy Policy]</a> for more details.
        </p>
    </div>

    <div id="voting-view" class="view-section">
        <h1>Vote for a Song</h1>
        <p>Choose wisely. You can only vote once.</p>
        
        <div id="song-list">
            <button class="song-btn" onclick="vote('Song A')">Song A</button>
            <button class="song-btn" onclick="vote('Song B')">Song B</button>
            <button class="song-btn" onclick="vote('Song C')">Song C</button>
            <button class="song-btn" onclick="vote('Song D')">Song D</button>
        </div>
    </div>

    <div id="thank-you-view" class="view-section">
        <h1>Thank You!</h1>
        <p>Your vote has been counted.</p>
        <p>Make sure to pre-save the new album below:</p>
        
        <div class="presave-links">
            <a href="https://open.spotify.com/prerelease/6d8BDUivKfBN7BpoIHVysH?si=W2xsqY_qQpiA89_KnmOvpw&go=1&utm_source=Original_Original&utm_medium=Original&utm_content=35109ff5-20ba-4aba-9a2b-889953073670_none_Luke%20Combs_none_none_none_20251218_https%3A%2F%2Ftwia.lukecombs.com%2F_sony-music-nashville_US_lc.lnk.to%2Fthewayiam" target="_blank" class="spotify">
                Pre-save on Spotify
            </a>
            <a href="https://music.apple.com/us/album/1862634688?at=1l3vpUI&app=music&ct=LFV_bac77ed7ce3935308407bd6301d8a6fe&itscg=30440&itsct=catchall_p1&lId=214897266&cId=none&sr=1&src=Linkfire&ls=1" target="_blank" class="apple">
                Pre-add on Apple Music
            </a>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        // 1. Handle Form Submission
        document.getElementById('marketing-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                postcode: document.getElementById('postcode').value
            };

            // Send data to server
            socket.emit('submitUserData', userData);
        });

        // 2. Server confirms registration -> Show Voting Page
        socket.on('registrationSuccess', () => {
            document.getElementById('landing-view').classList.remove('active');
            document.getElementById('voting-view').classList.add('active');
        });

        // 3. Handle Voting
        function vote(songName) {
            // Send vote to server
            socket.emit('castVote', songName);

            // Immediately switch to Thank You page (One vote only logic)
            document.getElementById('voting-view').classList.remove('active');
            document.getElementById('thank-you-view').classList.add('active');
        }
    </script>
</body>
</html>